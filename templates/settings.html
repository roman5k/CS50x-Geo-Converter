{% extends "layout.html" %}
{% block title %}
    Settings
{% endblock %}
{% block main %}
    <!-- cs50 duck and gpt-4o and youtube was used to help with this -->
    <div class="container">
        <!-- Change Password Form -->
        <h2 class="mt-5">Change Password</h2>
        <form class="mt-3" action="/change_password" method="post">
            <div class="form-group mb-3">
                <div class="input-group">
                    <input
                        type="password"
                        class="form-control"
                        id="old_password"
                        name="old_password"
                        placeholder="Current Password"
                        required
                        aria-label="Current Password"
                    >
                    <button type="button" class="input-group-text toggle-password" data-target="#old_password" aria-label="Toggle password visibility">
                        <i class="bi bi-eye-slash" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <div class="form-group mb-3">
                <div class="input-group">
                    <input
                        type="password"
                        class="form-control"
                        id="new_password"
                        name="new_password"
                        placeholder="New Password"
                        required
                        aria-label="New Password"
                    >
                    <button type="button" class="input-group-text toggle-password" data-target="#new_password" aria-label="Toggle password visibility">
                        <i class="bi bi-eye-slash" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <div class="form-group mb-3">
                <div class="input-group">
                    <input
                        type="password"
                        class="form-control"
                        id="confirm_password"
                        name="confirm_password"
                        placeholder="Confirm New Password"
                        required
                        aria-label="Confirm New Password"
                    >
                    <button type="button" class="input-group-text toggle-password" data-target="#confirm_password" aria-label="Toggle password visibility">
                        <i class="bi bi-eye-slash" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <button class="btn btn-primary" type="submit">Change Password</button>
        </form>

        <!-- Delete Account Form -->
        <h2 class="mt-5">Delete Account</h2>
        <form class="mt-3" action="/delete_account" method="post">
            <div class="form-group mb-3">
                <div class="input-group">
                    <input
                        type="password"
                        class="form-control"
                        id="delete_password"
                        name="password"
                        placeholder="Password"
                        required
                        aria-label="Password"
                    >
                    <button type="button" class="input-group-text toggle-password" data-target="#delete_password" aria-label="Toggle password visibility">
                        <i class="bi bi-eye-slash" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <button class="btn btn-danger" type="submit">Delete Account</button>
        </form>
    </div>

    <!-- Updated Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" integrity="sha384-" crossorigin="anonymous">

    <!-- cs50 duck and gpt-4o and youtube was used to help with this -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Select all toggle-password elements
            const togglePasswordElements = document.querySelectorAll('.toggle-password');

            togglePasswordElements.forEach(function (toggle) {
                toggle.addEventListener('click', function () {
                    const targetInputSelector = this.getAttribute('data-target');
                    const targetInput = document.querySelector(targetInputSelector);

                    if (!targetInput) {
                        console.error(`No input found for selector: ${targetInputSelector}`);
                        return;
                    }

                    // Toggle the input type
                    if (targetInput.type === 'password') {
                        targetInput.type = 'text';
                        // Change icon to 'eye'
                        this.querySelector('i.bi').classList.remove('bi-eye-slash');
                        this.querySelector('i.bi').classList.add('bi-eye');
                        // Update aria-label
                        this.setAttribute('aria-label', 'Hide password');
                    } else {
                        targetInput.type = 'password';
                        // Change icon to 'eye-slash'
                        this.querySelector('i.bi').classList.remove('bi-eye');
                        this.querySelector('i.bi').classList.add('bi-eye-slash');
                        // Update aria-label
                        this.setAttribute('aria-label', 'Show password');
                    }
                });
            });
        });
    </script>
{% endblock %}
